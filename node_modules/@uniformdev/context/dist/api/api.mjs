var V=Object.defineProperty;var Q=(r,e,t)=>e in r?V(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var h=(r,e,t)=>(Q(r,typeof e!="symbol"?e+"":e,t),t),H=(r,e,t)=>{if(!e.has(r))throw TypeError("Cannot "+t)};var s=(r,e,t)=>(H(r,e,"read from private field"),t?t.call(r):e.get(r)),p=(r,e,t)=>{if(e.has(r))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(r):e.set(r,t)};var $=async r=>await r(),g=class extends Error{constructor(t,i,o,a,c,m){super(`${t}
 ${a}${c?" "+c:""} (${i} ${o}${m?` Request ID: ${m}`:""})`);this.errorMessage=t;this.fetchMethod=i;this.fetchUri=o;this.statusCode=a;this.statusText=c;this.requestId=m;Object.setPrototypeOf(this,g.prototype)}};var n=class{constructor(e){h(this,"options");var t,i,o,a,c,m;if(!e.apiKey&&!e.bearerToken)throw new Error("You must provide an API key or a bearer token");this.options={...e,fetch:(t=e.fetch)!=null?t:fetch,apiHost:(i=e.apiHost)!=null?i:"https://uniform.app",apiKey:(o=e.apiKey)!=null?o:null,projectId:(a=e.projectId)!=null?a:null,bearerToken:(c=e.bearerToken)!=null?c:null,limitPolicy:(m=e.limitPolicy)!=null?m:$}}async apiClient(e,t){return this.options.limitPolicy(async()=>{var a;let i=this.options.apiKey?{"x-api-key":this.options.apiKey}:{Authorization:`Bearer ${this.options.bearerToken}`},o=await fetch(e.toString(),{...t,headers:{...t==null?void 0:t.headers,...i}});if(!o.ok){let c="";try{let m=await o.text();try{let C=JSON.parse(m);C.errorMessage?c=Array.isArray(C.errorMessage)?C.errorMessage.join(", "):C.errorMessage:c=m}catch(C){c=m}}catch(m){c="General error"}throw new g(c,(a=t==null?void 0:t.method)!=null?a:"GET",e.toString(),o.status,o.statusText,n.getRequestId(o))}return t!=null&&t.expectNoContent?null:await o.json()})}createUrl(e,t){let i=new URL(`${this.options.apiHost}${e}`);return Object.entries(t!=null?t:{}).forEach(([o,a])=>{var c;typeof a!="undefined"&&a!==null&&i.searchParams.append(o,(c=a==null?void 0:a.toString())!=null?c:"")}),i}static getRequestId(e){let t=e.headers.get("x-nf-request-id");if(t)return t}};var f,D=class extends n{constructor(e){super(e)}async get(e){let{projectId:t}=this.options,i=this.createUrl(s(D,f),{...e,projectId:t});return await this.apiClient(i)}async upsert(e){let t=this.createUrl(s(D,f));await this.apiClient(t,{method:"PUT",body:JSON.stringify({...e,projectId:this.options.projectId}),expectNoContent:!0})}async remove(e){let t=this.createUrl(s(D,f));await this.apiClient(t,{method:"DELETE",body:JSON.stringify({...e,projectId:this.options.projectId}),expectNoContent:!0})}},U=D;f=new WeakMap,p(U,f,"/api/v2/aggregate");var A,L=class extends n{constructor(e){super(e)}async get(e){let{projectId:t}=this.options,i=this.createUrl(s(L,A),{...e,projectId:t});return await this.apiClient(i)}},R=L;A=new WeakMap,p(R,A,"/api/v2/dimension");var d,I,y=class extends n{constructor(e){super(e)}async get(e){let{projectId:t}=this.options,i=this.createUrl(s(y,d),{...e,projectId:t});return await this.apiClient(i)}async upsertCategory(e){let t=this.createUrl(s(y,d));await this.apiClient(t,{method:"PUT",body:JSON.stringify({...e,projectId:this.options.projectId}),expectNoContent:!0})}async removeCategory(e){let t=this.createUrl(s(y,d));await this.apiClient(t,{method:"DELETE",body:JSON.stringify({...e,projectId:this.options.projectId}),expectNoContent:!0})}async upsertValue(e){let t=this.createUrl(s(y,I));await this.apiClient(t,{method:"PUT",body:JSON.stringify({...e,projectId:this.options.projectId}),expectNoContent:!0})}async removeValue(e){let t=this.createUrl(s(y,I));await this.apiClient(t,{method:"DELETE",body:JSON.stringify({...e,projectId:this.options.projectId}),expectNoContent:!0})}},P=y;d=new WeakMap,I=new WeakMap,p(P,d,"/api/v1/enrichments"),p(P,I,"/api/v1/enrichment-values");var k,v=class extends n{constructor(e){super(e)}async get(e){let{projectId:t}=this.options,i=this.createUrl(s(v,k),{...e,projectId:t});return await this.apiClient(i)}},T=v;k=new WeakMap,p(T,k,"/api/v2/manifest");var x,G=class extends n{constructor(e){super(e)}async get(e){let{projectId:t}=this.options,i=this.createUrl(s(G,x),{...e,projectId:t});return await this.apiClient(i)}async upsert(e){let t=this.createUrl(s(G,x));await this.apiClient(t,{method:"PUT",body:JSON.stringify({...e,projectId:this.options.projectId}),expectNoContent:!0})}async remove(e){let t=this.createUrl(s(G,x));await this.apiClient(t,{method:"DELETE",body:JSON.stringify({...e,projectId:this.options.projectId}),expectNoContent:!0})}},O=G;x=new WeakMap,p(O,x,"/api/v2/quirk");var E,b=class extends n{constructor(e){super(e)}async get(e){let{projectId:t}=this.options,i=this.createUrl(s(b,E),{...e,projectId:t});return await this.apiClient(i)}async upsert(e){let t=this.createUrl(s(b,E));await this.apiClient(t,{method:"PUT",body:JSON.stringify({...e,projectId:this.options.projectId}),expectNoContent:!0})}async remove(e){let t=this.createUrl(s(b,E));await this.apiClient(t,{method:"DELETE",body:JSON.stringify({...e,projectId:this.options.projectId}),expectNoContent:!0})}},w=b;E=new WeakMap,p(w,E,"/api/v2/signal");var j,S=class extends n{constructor(e){super(e)}async get(e){let{projectId:t}=this.options,i=this.createUrl(s(S,j),{...e,projectId:t});return await this.apiClient(i)}async upsert(e){let t=this.createUrl(s(S,j));await this.apiClient(t,{method:"PUT",body:JSON.stringify({...e,projectId:this.options.projectId}),expectNoContent:!0})}async remove(e){let t=this.createUrl(s(S,j));await this.apiClient(t,{method:"DELETE",body:JSON.stringify({...e,projectId:this.options.projectId}),expectNoContent:!0})}},N=S;j=new WeakMap,p(N,j,"/api/v2/test");var M=class{constructor(e){h(this,"enrichments");h(this,"aggregates");h(this,"dimensions");h(this,"manifest");h(this,"quirks");h(this,"signals");h(this,"tests");this.enrichments=new P(e),this.aggregates=new U(e),this.dimensions=new R(e),this.manifest=new T(e),this.quirks=new O(e),this.signals=new w(e),this.tests=new N(e)}};var J="_";function K(r){let e=r.category==="ENR"?"Enrichment":r.category==="SIG"?"Signal":r.subcategory==="1"?"Intent":r.subcategory==="0"?"Audience":"Aggregate";return{dim:r.dim,name:r.name,type:e,category:r.category==="ENR"?r.subcategory:void 0}}function Ee(r,e){var t,i,o,a;if((i=(t=e.project.pz)==null?void 0:t.agg)!=null&&i[r])return{dim:r,name:r,type:"Aggregate"};if((a=(o=e.project.pz)==null?void 0:o.sig)!=null&&a[r])return{dim:r,name:r,type:"Signal"};if(r.indexOf(J)>=0){let[c,m]=r.split(J);return{dim:r,name:m,type:"Enrichment",category:c}}}function je(r){let{type:e,name:t}=K(r);return`${e}: ${t}`}export{U as AggregateClient,g as ApiClientError,M as ContextClient,R as DimensionClient,P as EnrichmentClient,T as ManifestClient,O as QuirkClient,w as SignalClient,K as computeDimensionDefinitionDisplayData,Ee as computeDimensionDisplayData,je as computeDimensionDisplayName,$ as nullLimitPolicy};
