var d=Object.create;var u=Object.defineProperty;var I=Object.getOwnPropertyDescriptor;var P=Object.getOwnPropertyNames;var C=Object.getPrototypeOf,y=Object.prototype.hasOwnProperty;var N=(i=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(i,{get:(t,e)=>(typeof require!="undefined"?require:t)[e]}):i)(function(i){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+i+'" is not supported')});var R=(i,t)=>()=>(i&&(t=i(i=0)),t);var S=(i,t)=>()=>(t||i((t={exports:{}}).exports,t),t.exports);var T=(i,t,e,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of P(t))!y.call(i,n)&&n!==e&&u(i,n,{get:()=>t[n],enumerable:!(o=I(t,n))||o.enumerable});return i};var x=(i,t,e)=>(e=i!=null?d(C(i)):{},T(t||!i||!i.__esModule?u(e,"default",{value:i,enumerable:!0}):e,i));var c=R(()=>{});c();import O from"p-throttle";import g from"p-retry";function f({throttle:i={interval:1e3,limit:10},retry:t={retries:1,factor:1.66}}){let e=i?O(i):null;return function(n){let s=async()=>await n();if(e&&(s=e(s)),t){let r=s;s=()=>g(r,t)}return s()}}var U=async i=>await i();c();var l=class extends Error{constructor(e,o,n,s,r,p){super(`${e}
 ${s}${r?" "+r:""} (${o} ${n}${p?` Request ID: ${p}`:""})`);this.errorMessage=e;this.fetchMethod=o;this.fetchUri=n;this.statusCode=s;this.statusText=r;this.requestId=p;Object.setPrototypeOf(this,l.prototype)}},m=class{constructor(t){var o,n,s,r,p;if(!t.apiKey&&!t.bearerToken)throw new Error("You must provide an API key or a bearer token");let e=t.fetch;if(!e)if(typeof window!="undefined")e=window.fetch.bind(window);else if(typeof fetch!="undefined")e=fetch;else throw new Error("You must provide or polyfill a fetch implementation when not in a browser");this.options={...t,fetch:e,apiHost:(o=t.apiHost)!=null?o:"https://uniform.app",apiKey:(n=t.apiKey)!=null?n:null,projectId:(s=t.projectId)!=null?s:null,bearerToken:(r=t.bearerToken)!=null?r:null,limitPolicy:(p=t.limitPolicy)!=null?p:f({})}}async getCompositionList(t){let{projectId:e}=this.options,o=this.createUrl("/api/v1/canvas",{...t,projectId:e});return await this.apiClient(o)}async getCompositionBySlug(t){let{projectId:e}=this.options,o=this.createUrl("/api/v1/canvas",{...t,projectId:e});return await this.apiClient(o)}async getCompositionById(t){let{projectId:e}=this.options,o=this.createUrl("/api/v1/canvas",{...t,projectId:e});return await this.apiClient(o)}async updateComposition(t){let e=this.createUrl("/api/v1/canvas");await this.apiClient(e,{method:"PUT",body:JSON.stringify({...t,projectId:this.options.projectId}),expectNoContent:!0})}async removeComposition(t){let e=this.createUrl("/api/v1/canvas");await this.apiClient(e,{method:"DELETE",body:JSON.stringify({...t,projectId:this.options.projectId}),expectNoContent:!0})}async getComponentDefinitions(t){let{projectId:e}=this.options,o=this.createUrl("/api/v1/canvas-definitions",{...t,projectId:e});return await this.apiClient(o)}async updateComponentDefinition(t){let e=this.createUrl("/api/v1/canvas-definitions");await this.apiClient(e,{method:"PUT",body:JSON.stringify({...t,projectId:this.options.projectId}),expectNoContent:!0})}async removeComponentDefinition(t){let e=this.createUrl("/api/v1/canvas-definitions");await this.apiClient(e,{method:"DELETE",body:JSON.stringify({...t,projectId:this.options.projectId}),expectNoContent:!0})}async apiClient(t,e){return this.options.limitPolicy(async()=>{var s;let o=this.options.apiKey?{"x-api-key":this.options.apiKey}:{Authorization:`Bearer ${this.options.bearerToken}`},n=await this.options.fetch(t.toString(),{...e,headers:{...e==null?void 0:e.headers,...o}});if(!n.ok){let r="";try{let p=await n.text();try{let a=JSON.parse(p);a.errorMessage?r=Array.isArray(a.errorMessage)?a.errorMessage.join(", "):a.errorMessage:r=p}catch(a){r=p}}catch(p){r="General error"}throw new l(r,(s=e==null?void 0:e.method)!=null?s:"GET",t.toString(),n.status,n.statusText,m.getRequestId(n))}return e!=null&&e.expectNoContent?null:await n.json()})}createUrl(t,e){let o=new URL(`${this.options.apiHost}${t}`);return Object.entries(e!=null?e:{}).forEach(([n,s])=>{var r;typeof s!==void 0&&s!==null&&o.searchParams.append(n,(r=s==null?void 0:s.toString())!=null?r:"")}),o}static getRequestId(t){let e=t.headers.get("x-nf-request-id");if(e)return e}};c();var $="$personalization",q="$test",M="$localization",H="intentTag",F="locale",z="pz",K="test",G="localized",J=0,Y=64,Z="$pzCrit",B="$tstVrnt",Q="$enr";export{N as a,S as b,x as c,c as d,f as e,U as f,l as g,m as h,$ as i,q as j,M as k,H as l,F as m,z as n,K as o,G as p,J as q,Y as r,Z as s,B as t,Q as u};
