import{parse as p}from"cookie";import{CookieTransitionDataStore as k,UNIFORM_DEFAULT_COOKIE_NAME as x}from"@uniformdev/context";var f=class extends k{constructor({serverContext:t,...r}){super({...r,serverCookieValue:C(t)})}};function C(e,t=x){var o,n,s;if(!e)return;let r=p((n=(o=e.req)==null?void 0:o.headers.cookie)!=null?n:"");if((s=e==null?void 0:e.res)!=null&&s.getHeaders){let i=e.res.getHeaders()["set-cookie"];i&&(r={...r,...p(Array.isArray(i)?i[0]:i.toString())})}return r[t]}import{parse as g}from"cookie";import*as u from"react";function A(e,t){var n;let r=e.renderPage,{req:o}=e;o&&t.update({url:new URL(`https://${(n=o.headers.host)!=null?n:"unknown"}${o.url}`),cookies:o.headers.cookie?g(o.headers.cookie):void 0}),e.renderPage=s=>r({...s,enhanceApp:a=>c=>u.createElement(a,{...c,serverUniformContext:t})})}export{f as NextCookieTransitionDataStore,A as enableNextSsr};
