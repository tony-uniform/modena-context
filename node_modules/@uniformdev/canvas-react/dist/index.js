var z=Object.create;var P=Object.defineProperty;var D=Object.getOwnPropertyDescriptor;var F=Object.getOwnPropertyNames;var J=Object.getPrototypeOf,U=Object.prototype.hasOwnProperty;var X=(o,e)=>{for(var n in e)P(o,n,{get:e[n],enumerable:!0})},k=(o,e,n,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of F(e))!U.call(o,r)&&r!==n&&P(o,r,{get:()=>e[r],enumerable:!(t=D(e,r))||t.enumerable});return o};var E=(o,e,n)=>(n=o!=null?z(J(o)):{},k(e||!o||!o.__esModule?P(n,"default",{value:o,enumerable:!0}):n,o)),K=o=>k(P({},"__esModule",{value:!0}),o);var Y={};X(Y,{Composition:()=>g,DefaultNotImplementedComponent:()=>B,Slot:()=>M,useComposition:()=>S,useCompositionEventEffect:()=>L});module.exports=K(Y);var v=require("@uniformdev/context-react"),V=require("@uniformdev/canvas"),C=E(require("react"));function x(o){var t;let e=(t=o.parameters)!=null?t:{};return{...Object.keys(e).reduce((r,s)=>(r[s]=e[s].value,r),{}),...o.data,component:o}}var O=(0,C.createContext)(void 0);function S(){return(0,C.useContext)(O)}function g({data:o,resolveRenderer:e,children:n,behaviorTracking:t}){var p,a,f;let r=S(),s=(0,v.useUniformContext)({throwOnMissingProvider:!1})!==void 0;if(!o)return process.env.NODE_ENV==="development"&&console.warn("[canvas-dev] Composition was rendered with no data, nothing will be output."),null;let i={composition:o,resolveRenderer:e!=null?e:r==null?void 0:r.resolveRenderer,behaviorTracking:(p=t!=null?t:r==null?void 0:r.behaviorTracking)!=null?p:"onView"},d=(f=(a=o.parameters)==null?void 0:a[V.CANVAS_ENRICHMENT_TAG_PARAM])==null?void 0:f.value,l=i.behaviorTracking==="onLoad"?v.TrackFragment:v.Track,m=typeof n=="function"?n(x(o)):n;return C.default.createElement(O.Provider,{value:i},s?C.default.createElement(l,{behavior:d},m):m)}var T=E(require("react"));var R=require("@uniformdev/canvas");var h=require("@uniformdev/context-react"),N=require("@uniformdev/canvas"),w=E(require("react")),_={test:(o,e,n)=>{var d,l,m,p;let t=o,r=(l=(d=t.slots)==null?void 0:d.test)!=null?l:[],s=(p=(m=t.parameters.test)==null?void 0:m.value)!=null?p:"Untitled Test",i=(0,N.mapSlotToTestVariations)(r);return w.createElement(h.Test,{key:e,variations:i,name:s,component:a=>n(a,e)})},personalization:(o,e,n)=>{var s,i,d,l,m,p,a;let t=o,r=(0,N.mapSlotToPersonalizedVariations)((s=t==null?void 0:t.slots)==null?void 0:s.pz);return w.createElement(h.Personalize,{key:e,variations:r,count:Number((l=(d=(i=t.parameters)==null?void 0:i.count)==null?void 0:d.value)!=null?l:1),name:(a=(p=(m=t.parameters)==null?void 0:m.trackingEventName)==null?void 0:p.value)!=null?a:"Untitled Personalization",component:f=>n(f,0)})}};function M({name:o,resolveRenderer:e,children:n}){var p;let t=S();if(!(t!=null&&t.composition))throw new Error("Slot must be rendered within a Composition");let{composition:r,resolveRenderer:s}=t;if(!r)throw new Error("Cannot use Slot without a Composition wrapper.");let i=(p=r.slots)==null?void 0:p[o];if(!i||!Array.isArray(i))return process.env.NODE_ENV==="development"&&console.warn(`[canvas-dev] slot '${o}' was rendered, but it was not defined on its component. This is expected if the slot is optional, otherwise it may indicate a typo. Component:`,r),null;let d=e!=null?e:s,l=_,m=i.map((a,f)=>{let A=b({component:a,resolveRenderer:d,resolveSystem:l,key:f});return n?n({child:A,component:a,key:f}):A});return T.default.createElement(T.default.Fragment,void 0,m)}function b({component:o,resolveRenderer:e,resolveSystem:n,key:t=0}){let r=e==null?void 0:e(o);if(o.type===R.CANVAS_TEST_TYPE)return n.test(o,t,(s,i)=>b({component:s,resolveRenderer:e,resolveSystem:n,key:i}));if(o.type===R.CANVAS_PERSONALIZE_TYPE)return n.personalization(o,t,(s,i)=>b({component:s,resolveRenderer:e,resolveSystem:n,key:i}));if(r){let s=x(o);return T.default.createElement(g,{key:t,data:o,resolveRenderer:e},T.default.createElement(r,{...s}))}else process.env.NODE_ENV!=="production"&&console.warn(`[canvas] found component of type '${o.type}' which the resolveRenderer prop returned no component for. Nothing will be rendered. The resolveRenderer function may need to be extended to handle the new type.`,o);return null}var c=E(require("react"));function B(o){var n;let e=(n=o.component)==null?void 0:n.type;return e?c.default.createElement("div",{style:{borderLeft:"10px solid #e42535!important",padding:"0.01em 16px 16px",borderRadius:"16px",backgroundColor:"rgba(122, 215, 218, 0.3)",color:"#1d3557"}},c.default.createElement("h2",null,"Component: ",e),c.default.createElement("p",null,c.default.createElement("strong",null,e)," has no React implementation. It may need to be added to your"," ",c.default.createElement("code",null,"resolveRenderer()")," function."),c.default.createElement("details",null,c.default.createElement("summary",null,"Props"),c.default.createElement("pre",null,JSON.stringify(o,null,2)))):null}var y=require("@uniformdev/canvas"),I=require("react");function L({enabled:o,projectId:e,compositionId:n,effect:t}){(0,I.useEffect)(()=>{if(!o||!n||!e)return;let r;return(async()=>{let i=await(0,y.createEventBus)();i&&(r=(0,y.subscribeToComposition)({eventBus:i,compositionId:n,compositionState:y.CANVAS_DRAFT_STATE,projectId:e,callback:t,event:"updated"}))})(),()=>{r&&r()}},[n,o,e,t])}0&&(module.exports={Composition,DefaultNotImplementedComponent,Slot,useComposition,useCompositionEventEffect});
